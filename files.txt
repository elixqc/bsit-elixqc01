<?PHP

$foldername = 'TEST_FOLDER';

if (!is_dir($foldername)){
    mkdir($foldername);
    echo "1. Folder 'Test_Folder' created.";
}
else {
    echo "1. Folder 'Test_Folder' already exists.";
}

$artistList = array (
    "10 Filipino Artists in the Philippines (showbiz)",
    "1. Jhong hillarious",
    "2. Willie navarro",
    "3. John Siep",
    "4. Joseph hehe",
    "5. He;lo world",
    "6. What the damz",
    "7. ermm what the frigma",
    "8. ello po",
    "9. what the fuck",
    "10. >>",
);

file_put_contents("artist.txt", $artistList[0] . "\n");
file_put_contents("artist.txt", $artistList[1] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[2] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[3] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[4] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[5] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[6] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[7] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[8] . "\n", FILE_APPEND);
file_put_contents("artist.txt", $artistList[9] . "\n", FILE_APPEND);

?>
<?php
session_start();

$User = "yourname";
$Pass = "BSIT";

if (isset($_GET['logout'])) {
    session_destroy();
    setcookie("username", "", time() - (86400 * 2), "/");
    header("Location: 8_2.php");
    exit();
}

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['login'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];
    
    if ($username === $User && $password === $Pass) {
        $_SESSION['username'] = $username;
        
        if (isset($_POST['remember'])) {
            setcookie("username", $username, time() + (86400 * 2), "/");
        }
        
        header("Location: 8_2.php");
        exit();
    } else {
        $error = "Invalid username or password.";
    }
}

$isLoggedIn = false;
if (isset($_SESSION['username'])) {
    $isLoggedIn = true;
    $currentUser = $_SESSION['username'];
} elseif (isset($_COOKIE['username'])) {
    $isLoggedIn = true;
    $currentUser = $_COOKIE['username'];
    $_SESSION['username'] = $_COOKIE['username'];
}

$students = [
    "John Michael Smith",
    "Maria Isabel Garcia",
    "Robert James Johnson",
    "Ana Sofia Rodriguez",
    "David Alexander Brown",
    "Carmen Elena Martinez",
    "Michael Christopher Davis",
    "Isabella Marie Lopez",
    "William Anthony Wilson",
    "Sofia Valentina Hernandez"
];
?>

<!DOCTYPE html>
<html>
<head>
    <title>Student Management System</title>
</head>
<body>
    <h1>Student Management System</h1>

    <?php if (!$isLoggedIn): ?>
        <h2>Login</h2>
        <form method="POST">
            <label>Username: <input type="text" name="username" required></label><br><br>
            <label>Password: <input type="password" name="password" required></label><br><br>
            <label><input type="checkbox" name="remember"> Remember Me</label><br><br>
            <button type="submit" name="login" method = "POST">Login</button>
        </form>
        <?php if (isset($error)) echo "<p style='color:red;'>$error</p>"; ?>
    <?php else: ?>
        <h2>Welcome, <?php echo $currentUser; ?>!</h2>
        
        <div>
            <h3>Browse Students</h3>
            <h4>List of Students:</h4>
            <ol>
                <?php foreach ($students as $student): ?>
                    <li><?php echo $student; ?></li>
                <?php endforeach; ?>
            </ol>
        </div>
        
        <a href="?logout=1">Logout</a>
    <?php endif; ?>
</body>
</html>




<?php
session_start();

$users = [
    'admin' => ['password' => 'admin123', 'role' => 'Admin'],
    'editor' => ['password' => 'editor123', 'role' => 'Editor'],
    'viewer' => ['password' => 'viewer123', 'role' => 'Viewer']
];

$uploadDir = 'uploads/';
if (!is_dir($uploadDir)) {
    mkdir($uploadDir, 0754, true);
}

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['login'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];
    
    if (isset($users[$username]) && $users[$username]['password'] === $password) {
        $_SESSION['username'] = $username;
        $_SESSION['role'] = $users[$username]['role'];
    } else {
        $error = "Invalid username or password.";
    }
}

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['upload'])) {
    if ($_SESSION['role'] === 'Admin') {
        $allowedMimeTypes = [
            'application/pdf',
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
            'video/mp4',
            'audio/mpeg'
        ];
        
        $allowedExtensions = ['pdf', 'docx', 'mp4', 'mp3'];
        $maxFileSize = 100 * 1024 * 1024;
        
        if (isset($_FILES['file_upload']) && $_FILES['file_upload']['error'] === 0) {
            $file = $_FILES['file_upload'];
            $fileName = $file['name'];
            $fileSize = $file['size'];
            $fileTmpName = $file['tmp_name'];
            $fileMimeType = $file['type'];
            
            $fileExtension = strtolower(pathinfo($fileName, PATHINFO_EXTENSION));
            
            if ($fileSize > $maxFileSize) {
                $message = "Error: File size exceeds 100MB limit.";
            }
            elseif (!in_array($fileMimeType, $allowedMimeTypes) || !in_array($fileExtension, $allowedExtensions)) {
                $message = "Error: Only PDF, DOCX, MP4, and MP3 files are allowed.";
            }
            else {
                $destination = $uploadDir . $fileName;
                if (move_uploaded_file($fileTmpName, $destination)) {
                    $message = "File uploaded successfully!";
                } else {
                    $message = "Error: Failed to upload file.";
                }
            }
        } else {
            $message = "Error: No file selected or upload error occurred.";
        }
    } else {
        $message = "Error: Only Admin users can upload files.";
    }
}

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['delete'])) {
    if ($_SESSION['role'] === 'Admin' || $_SESSION['role'] === 'Editor') {
        $fileToDelete = $_POST['file_to_delete'];
        $filePath = $uploadDir . $fileToDelete;
        
        if (file_exists($filePath)) {
            if (unlink($filePath)) {
                $message = "File deleted successfully!";
            } else {
                $message = "Error: Failed to delete file.";
            }
        } else {
            $message = "Error: File does not exist.";
        }
    } else {
        $message = "Error: You don't have permission to delete files.";
    }
}

$files = [];
if (is_dir($uploadDir)) {
    $allFiles = scandir($uploadDir);
    $files = array_filter($allFiles, function($file) {
        return $file !== '.' && $file !== '..';
    });
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>Multimedia Archive</title>
</head>
<body>
    <h1>Multimedia Archive</h1>

    <?php if (!isset($_SESSION['username'])): ?>
        <h2>Login</h2>
        <form method="POST">
            <label>Username: <input type="text" name="username" required></label><br>
            <label>Password: <input type="password" name="password" required></label><br>
            <button type="submit" name="login">Login</button>
        </form>
        <?php if (isset($error)) echo "<p style='color:red;'>$error</p>"; ?>
    <?php else: ?>
        <h2>Welcome, <?php echo $_SESSION['username']; ?> (<?php echo $_SESSION['role']; ?>)</h2>
       
        <?php if ($_SESSION['role'] === 'Admin'): ?>
            <h3>Upload File</h3>
            <form method="POST" enctype="multipart/form-data">
                <input type="file" name="file_upload" required>
                <button type="submit" name="upload">Upload</button>
            </form>
        <?php endif; ?>

        <h3>Uploaded Files</h3>
        <table border="1">
            <tr>
                <th>File Name</th>
                <th>Action</th>
            </tr>
            <?php if (empty($files)): ?>
                <tr>
                    <td colspan="2">No files uploaded yet.</td>
                </tr>
            <?php else: ?>
                <?php foreach ($files as $file): ?>
                    <tr>
                        <td><?php echo htmlspecialchars($file); ?></td>
                        <td>
                            <?php if ($_SESSION['role'] === 'Admin' || $_SESSION['role'] === 'Editor'): ?>
                                <form method="POST" style="display:inline;">
                                    <input type="hidden" name="file_to_delete" value="<?php echo htmlspecialchars($file); ?>">
                                    <button type="submit" name="delete">Delete</button>
                                </form>
                            <?php endif; ?>
                        </td>
                    </tr>
                <?php endforeach; ?>
            <?php endif; ?>
        </table>
        
        <p><?php if (isset($message)) echo $message; ?></p>
        
        <a href="logout.php">Logout</a>
    <?php endif; ?>
</body>
</html>



<?php
session_start();
session_destroy();
header("Location: index.php");
exit();
?>