Imports MySql.Data.MySqlClient
Public Class name

    Dim conn As New MySqlConnection("server=localhost;userid=root;password=;database=student_department")

    Sub LoadData()
        Dim adapter As New MySqlDataAdapter("SELECT * FROM applicants", conn)
        Dim table As New DataTable()
        adapter.Fill(table)
        DataGridView1.DataSource = table
    End Sub
    Private Sub name_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        LoadData()
    End Sub

    Private Sub btnSubmit_Click(sender As Object, e As EventArgs) Handles btnSubmit.Click
        conn.Open()
        Dim cmd As New MySqlCommand("INSERT INTO applicants(name, email, department, phoneNumber) VALUES (@name, @email, @department, @phoneNumber)", conn)

        cmd.Parameters.AddWithValue("@name", txtName.Text)
        cmd.Parameters.AddWithValue("@email", txtEmail.Text)
        cmd.Parameters.AddWithValue("@department", txtDepartment.Text)
        cmd.Parameters.AddWithValue("@phoneNumber", txtPhone.Text)

        cmd.ExecuteNonQuery()
        conn.Close()

        LoadData()
        MsgBox("Success!")

    End Sub
End Class
--------------------------------------------------------------------------------------------

